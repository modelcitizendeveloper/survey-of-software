Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
============================================================
Recipe Ingredient Embeddings - Word2Vec Training
============================================================

Configuration:
  window      : 5
  min_count   : 20
  epochs      : 10
  negative    : 15
  workers     : 7
  sample      : 0.001
  sg          : 1
  hs          : 0
  dimensions  : [50, 100, 300]
Loading ingredient lists from /home/ivanadamin/gt/research/crew/ivan/recipe-embeddings/data/processed/ingredient_lists.txt...
  Loaded 100,000 recipes...
  Loaded 200,000 recipes...
  Loaded 300,000 recipes...
  Loaded 400,000 recipes...
  Loaded 500,000 recipes...
  Loaded 600,000 recipes...
  Loaded 700,000 recipes...
  Loaded 800,000 recipes...
  Loaded 900,000 recipes...
  Loaded 1,000,000 recipes...
  Loaded 1,100,000 recipes...
  Loaded 1,200,000 recipes...
  Loaded 1,300,000 recipes...
  Loaded 1,400,000 recipes...
  Loaded 1,500,000 recipes...
  Loaded 1,600,000 recipes...
  Loaded 1,700,000 recipes...
  Loaded 1,800,000 recipes...
  Loaded 1,900,000 recipes...
  Loaded 2,000,000 recipes...
  Loaded 2,100,000 recipes...
  Loaded 2,200,000 recipes...

✓ Loaded 2,230,570 recipes
  Average ingredients per recipe: 8.5
  Raw vocabulary: 198,882 unique ingredients

  Vocabulary at different min_count thresholds:
    min_count=  1: 198,882 ingredients
    min_count=  5: 32,597 ingredients
    min_count= 10: 19,870 ingredients
    min_count= 20: 12,767 ingredients
    min_count= 50:  7,239 ingredients
    min_count=100:  4,804 ingredients

============================================================
Training 50d model
============================================================

✓ Training complete in 164.7s (2.7 minutes)
  Vocabulary size: 12,767 ingredients
  Total training samples: 18,921,287

============================================================
Testing 50d model
============================================================

1. Ingredient Similarity:

  'butter' is similar to:
    0.860  margarine
    0.808  butter +
    0.805  sweet butter
    0.779  unsalted butter
    0.746  buter

  'chicken' is similar to:
    0.894  chicken breasts
    0.867  chicken breast
    0.866  chicken meat
    0.862  chicken thighs
    0.819  chicken tenders

  'garlic' is similar to:
    0.904  clove garlic
    0.902  cloves garlic
    0.892  fresh garlic
    0.808  clove of garlic
    0.770  cloves of garlic

  'chocolate' is similar to:
    0.899  milk chocolate
    0.894  semi-sweet chocolate
    0.891  semisweet chocolate
    0.887  semi sweet chocolate
    0.882  dark chocolate

2. Analogies (X - A + B = ?):

  butter - dairy + vegan = ?
    SKIP: Words not in vocabulary: ['dairy']

  milk - dairy + vegan = ?
    SKIP: Words not in vocabulary: ['dairy']

  flour - wheat + gluten-free = ?
    SKIP: Words not in vocabulary: ['wheat', 'gluten-free']

  beef - meat + vegetarian = ?
    Top 5 results:
      0.701  grillers
      0.685  vegan cheese
      0.671  soy crumbles
      0.660  vegetarian baked beans
      0.658  veggie burger
    Expected one of: ['mushrooms', 'tofu', 'lentils', 'beans']

  egg - bacon + orange juice = ?
    Top 5 results:
      0.639  egg white
      0.626  freshly grated orange peel
      0.610  orange juice concentrate
      0.610  glaze
      0.604  sweet orange marmalade
    Expected one of: ['coffee', 'milk']

  Analogy accuracy: 0/2 (0.0%)

3. Compound Ingredients (NER test):

  'cream of mushroom soup':
    0.937  mushroom soup
    0.892  cream of celery soup
    0.886  condensed mushroom soup

  'cream of chicken soup':
    0.917  cream of chicken
    0.912  chicken soup
    0.883  cream chicken soup

  'sour cream':
    0.813  light sour cream
    0.769  regular sour cream
    0.750  low-fat sour cream

  'brown sugar':
    0.924  dark brown sugar
    0.918  light brown sugar
    0.827  brown suger

  'olive oil':
    0.937  extra virgin olive oil
    0.862  virgin olive oil
    0.852  evoo

✓ Saved model to /home/ivanadamin/gt/research/crew/ivan/recipe-embeddings/models/recipe_embeddings_50d.model
✓ Saved vectors to /home/ivanadamin/gt/research/crew/ivan/recipe-embeddings/models/recipe_embeddings_50d.kv
✓ Saved text format to /home/ivanadamin/gt/research/crew/ivan/recipe-embeddings/models/recipe_embeddings_50d.txt
✓ Saved metadata to /home/ivanadamin/gt/research/crew/ivan/recipe-embeddings/models/recipe_embeddings_50d_metadata.json
Traceback (most recent call last):
  File "/home/ivanadamin/gt/research/crew/ivan/recipe-embeddings/scripts/train_embeddings.py", line 315, in <module>
    main()
  File "/home/ivanadamin/gt/research/crew/ivan/recipe-embeddings/scripts/train_embeddings.py", line 294, in main
    save_model(model, dim, output_dir)
  File "/home/ivanadamin/gt/research/crew/ivan/recipe-embeddings/scripts/train_embeddings.py", line 258, in save_model
    json.dump(sample_data, f, indent=2)
  File "/usr/lib/python3.12/json/__init__.py", line 179, in dump
    for chunk in iterable:
  File "/usr/lib/python3.12/json/encoder.py", line 430, in _iterencode
    yield from _iterencode_list(o, _current_indent_level)
  File "/usr/lib/python3.12/json/encoder.py", line 326, in _iterencode_list
    yield from chunks
  File "/usr/lib/python3.12/json/encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "/usr/lib/python3.12/json/encoder.py", line 439, in _iterencode
    o = _default(o)
        ^^^^^^^^^^^
  File "/usr/lib/python3.12/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type int64 is not JSON serializable
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
Exception ignored in: 'gensim.models.word2vec_inner.our_dot_float'
============================================================
Recipe Ingredient Embeddings - Word2Vec Training
============================================================

Configuration:
  window      : 5
  min_count   : 20
  epochs      : 10
  negative    : 15
  workers     : 7
  sample      : 0.001
  sg          : 1
  hs          : 0
  dimensions  : [50, 100, 300]
Loading ingredient lists from /home/ivanadamin/gt/research/crew/ivan/recipe-embeddings/data/processed/ingredient_lists.txt...
  Loaded 100,000 recipes...
  Loaded 200,000 recipes...
  Loaded 300,000 recipes...
  Loaded 400,000 recipes...
  Loaded 500,000 recipes...
  Loaded 600,000 recipes...
  Loaded 700,000 recipes...
  Loaded 800,000 recipes...
  Loaded 900,000 recipes...
  Loaded 1,000,000 recipes...
  Loaded 1,100,000 recipes...
  Loaded 1,200,000 recipes...
  Loaded 1,300,000 recipes...
  Loaded 1,400,000 recipes...
  Loaded 1,500,000 recipes...
  Loaded 1,600,000 recipes...
  Loaded 1,700,000 recipes...
  Loaded 1,800,000 recipes...
  Loaded 1,900,000 recipes...
  Loaded 2,000,000 recipes...
  Loaded 2,100,000 recipes...
  Loaded 2,200,000 recipes...

✓ Loaded 2,230,570 recipes
  Average ingredients per recipe: 8.5
  Raw vocabulary: 198,882 unique ingredients

  Vocabulary at different min_count thresholds:
    min_count=  1: 198,882 ingredients
    min_count=  5: 32,597 ingredients
    min_count= 10: 19,870 ingredients
    min_count= 20: 12,767 ingredients
    min_count= 50:  7,239 ingredients
    min_count=100:  4,804 ingredients

============================================================
Training 50d model
============================================================

✓ Training complete in 174.9s (2.9 minutes)
  Vocabulary size: 12,767 ingredients
  Total training samples: 18,921,287

============================================================
Testing 50d model
============================================================

1. Ingredient Similarity:

  'butter' is similar to:
    0.851  margarine
    0.803  butter +
    0.781  unsalted butter
    0.756  sweet butter
    0.751  buter

  'chicken' is similar to:
    0.898  chicken breasts
    0.881  chicken breast
    0.865  chicken meat
    0.861  chicken thighs
    0.825  chicken tenders

  'garlic' is similar to:
    0.913  clove garlic
    0.904  fresh garlic
    0.894  cloves garlic
    0.815  clove of garlic
    0.777  cloves of garlic

  'chocolate' is similar to:
    0.907  semi sweet chocolate
    0.901  semi-sweet chocolate
    0.897  semisweet chocolate
    0.889  dark chocolate
    0.888  milk chocolate

2. Analogies (X - A + B = ?):

  butter - dairy + vegan = ?
    SKIP: Words not in vocabulary: ['dairy']

  milk - dairy + vegan = ?
    SKIP: Words not in vocabulary: ['dairy']

  flour - wheat + gluten-free = ?
    SKIP: Words not in vocabulary: ['wheat', 'gluten-free']

  beef - meat + vegetarian = ?
    Top 5 results:
      0.682  grillers
      0.675  vegan cheese
      0.672  veggie burger
      0.668  vegetarian sausages
      0.657  veggie burgers
    Expected one of: ['mushrooms', 'tofu', 'lentils', 'beans']

  egg - bacon + orange juice = ?
    Top 5 results:
      0.650  egg white
      0.616  freshly grated orange rind
      0.613  glaze
      0.613  pineapple-orange juice
      0.594  freshly grated orange
    Expected one of: ['coffee', 'milk']

  Analogy accuracy: 0/2 (0.0%)

3. Compound Ingredients (NER test):

  'cream of mushroom soup':
    0.944  mushroom soup
    0.892  condensed mushroom soup
    0.892  cream of celery soup

  'cream of chicken soup':
    0.924  cream of chicken
    0.917  chicken soup
    0.893  cream chicken soup

  'sour cream':
    0.808  light sour cream
    0.795  regular sour cream
    0.755  containers sour cream

  'brown sugar':
    0.927  dark brown sugar
    0.925  light brown sugar
    0.818  lightly packed brown sugar

  'olive oil':
    0.943  extra virgin olive oil
    0.864  virgin olive oil
    0.856  olive oil +

✓ Saved model to /home/ivanadamin/gt/research/crew/ivan/recipe-embeddings/models/recipe_embeddings_50d.model
✓ Saved vectors to /home/ivanadamin/gt/research/crew/ivan/recipe-embeddings/models/recipe_embeddings_50d.kv
✓ Saved text format to /home/ivanadamin/gt/research/crew/ivan/recipe-embeddings/models/recipe_embeddings_50d.txt
✓ Saved metadata to /home/ivanadamin/gt/research/crew/ivan/recipe-embeddings/models/recipe_embeddings_50d_metadata.json
✓ Saved sample vectors to /home/ivanadamin/gt/research/crew/ivan/recipe-embeddings/models/recipe_embeddings_50d_sample.json

============================================================
Training 100d model
============================================================

✓ Training complete in 250.0s (4.2 minutes)
  Vocabulary size: 12,767 ingredients
  Total training samples: 18,921,287

============================================================
Testing 100d model
============================================================

1. Ingredient Similarity:

  'butter' is similar to:
    0.823  margarine
    0.721  unsalted butter
    0.715  butter +
    0.644  buter
    0.643  oleo

  'chicken' is similar to:
    0.860  chicken breasts
    0.848  chicken breast
    0.805  chicken thighs
    0.759  chicken meat
    0.752  chicken tenders

  'garlic' is similar to:
    0.873  clove garlic
    0.809  fresh garlic
    0.746  clove of garlic
    0.735  cloves garlic
    0.693  garlic powder

  'chocolate' is similar to:
    0.852  semisweet chocolate
    0.848  milk chocolate
    0.846  semi-sweet chocolate
    0.833  bittersweet chocolate
    0.823  dark chocolate

2. Analogies (X - A + B = ?):

  butter - dairy + vegan = ?
    SKIP: Words not in vocabulary: ['dairy']

  milk - dairy + vegan = ?
    SKIP: Words not in vocabulary: ['dairy']

  flour - wheat + gluten-free = ?
    SKIP: Words not in vocabulary: ['wheat', 'gluten-free']

  beef - meat + vegetarian = ?
    Top 5 results:
      0.554  vegan cheese
      0.542  soy crumbles
      0.531  tempeh
      0.528  seitan
      0.524  vegetarian ground beef
    Expected one of: ['mushrooms', 'tofu', 'lentils', 'beans']

  egg - bacon + orange juice = ?
    Top 5 results:
      0.546  egg white
      0.541  pineapple-orange juice
      0.523  whipped butter
      0.515  orange blossom
      0.509  passion fruit nectar
    Expected one of: ['coffee', 'milk']

  Analogy accuracy: 0/2 (0.0%)

3. Compound Ingredients (NER test):

  'cream of mushroom soup':
    0.889  mushroom soup
    0.801  cream of mushroom
    0.786  cream of mushroom soup or cream of chicken soup

  'cream of chicken soup':
    0.844  cream of chicken
    0.844  chicken soup
    0.805  cream chicken soup

  'sour cream':
    0.765  light sour cream
    0.716  low-fat sour cream
    0.695  regular sour cream

  'brown sugar':
    0.886  light brown sugar
    0.877  dark brown sugar
    0.768  lightly packed brown sugar

  'olive oil':
    0.866  extra virgin olive oil
    0.761  extra-virgin olive oil
    0.749  virgin olive oil

✓ Saved model to /home/ivanadamin/gt/research/crew/ivan/recipe-embeddings/models/recipe_embeddings_100d.model
✓ Saved vectors to /home/ivanadamin/gt/research/crew/ivan/recipe-embeddings/models/recipe_embeddings_100d.kv
✓ Saved text format to /home/ivanadamin/gt/research/crew/ivan/recipe-embeddings/models/recipe_embeddings_100d.txt
✓ Saved metadata to /home/ivanadamin/gt/research/crew/ivan/recipe-embeddings/models/recipe_embeddings_100d_metadata.json
✓ Saved sample vectors to /home/ivanadamin/gt/research/crew/ivan/recipe-embeddings/models/recipe_embeddings_100d_sample.json

============================================================
Training 300d model
============================================================

✓ Training complete in 460.4s (7.7 minutes)
  Vocabulary size: 12,767 ingredients
  Total training samples: 18,921,287

============================================================
Testing 300d model
============================================================

1. Ingredient Similarity:

  'butter' is similar to:
    0.685  margarine
    0.645  unsalted butter
    0.596  butter +
    0.568  buter
    0.541  milk

  'chicken' is similar to:
    0.757  chicken breasts
    0.680  chicken breast
    0.648  chicken thighs
    0.596  chicken meat
    0.570  chicken chunks

  'garlic' is similar to:
    0.771  clove garlic
    0.599  fresh garlic
    0.572  galic
    0.569  clove of garlic
    0.552  garlic powder

  'chocolate' is similar to:
    0.699  bittersweet chocolate
    0.695  semisweet chocolate
    0.689  cocoa
    0.687  chocolate chips
    0.676  semi sweet

2. Analogies (X - A + B = ?):

  butter - dairy + vegan = ?
    SKIP: Words not in vocabulary: ['dairy']

  milk - dairy + vegan = ?
    SKIP: Words not in vocabulary: ['dairy']

  flour - wheat + gluten-free = ?
    SKIP: Words not in vocabulary: ['wheat', 'gluten-free']

  beef - meat + vegetarian = ?
    Top 5 results:
      0.389  vegetarian ground beef
      0.381  veggie burgers
      0.381  tempeh
      0.375  grillers
      0.371  soy crumbles
    Expected one of: ['mushrooms', 'tofu', 'lentils', 'beans']

  egg - bacon + orange juice = ?
    Top 5 results:
      0.462  pineapple-orange juice
      0.445  fresh orange juice
      0.439  passion fruit nectar
      0.427  honey +
      0.424  sugar crystals
    Expected one of: ['coffee', 'milk']

  Analogy accuracy: 0/2 (0.0%)

3. Compound Ingredients (NER test):

  'cream of mushroom soup':
    0.834  mushroom soup
    0.715  cream of mushroom
    0.699  cream of mushroom soup or cream of chicken soup

  'cream of chicken soup':
    0.763  cream of chicken
    0.719  cream chicken soup
    0.706  cream of chicken soup or cream of celery soup

  'sour cream':
    0.622  light sour cream
    0.588  low-fat sour cream
    0.587  containers sour cream

  'brown sugar':
    0.777  light brown sugar
    0.702  dark brown sugar
    0.667  lightly packed brown sugar

  'olive oil':
    0.709  extra virgin olive oil
    0.662  extra-virgin olive oil
    0.652  extra-virgin oil

✓ Saved model to /home/ivanadamin/gt/research/crew/ivan/recipe-embeddings/models/recipe_embeddings_300d.model
✓ Saved vectors to /home/ivanadamin/gt/research/crew/ivan/recipe-embeddings/models/recipe_embeddings_300d.kv
✓ Saved text format to /home/ivanadamin/gt/research/crew/ivan/recipe-embeddings/models/recipe_embeddings_300d.txt
✓ Saved metadata to /home/ivanadamin/gt/research/crew/ivan/recipe-embeddings/models/recipe_embeddings_300d_metadata.json
✓ Saved sample vectors to /home/ivanadamin/gt/research/crew/ivan/recipe-embeddings/models/recipe_embeddings_300d_sample.json

============================================================
Training Complete!
============================================================

Trained 3 models:
  50d: 12,767 ingredients, ~2.4MB
  100d: 12,767 ingredients, ~4.9MB
  300d: 12,767 ingredients, ~14.6MB

Models saved to: /home/ivanadamin/gt/research/crew/ivan/recipe-embeddings/models/

Next steps:
  1. Evaluate embeddings with validation set
  2. Build CLI tool: recipe-emb substitute <ingredient> --diet <diet>
  3. Test with real recipes
  4. Compare with food2vec results (if available)
