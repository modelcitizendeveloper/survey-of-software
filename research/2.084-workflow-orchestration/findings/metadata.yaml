experiment_number: "2.084"
title: "Workflow Orchestration Patterns for SMCP"
date: "2026-01-08"
status: completed

description: |
  Research extraction of workflow orchestration patterns from Temporal, Apache Airflow,
  Prefect, and Dagster for implementing a lightweight SMCP (Simple MCP) workflow
  orchestration layer called Judith.

scope:
  target_scale: "Single node to small cluster"
  not_enterprise: true
  focus: "MCP tool orchestration patterns"

key_questions_answered:
  - question: "How do tools define workflows?"
    answer: "Code-first (Temporal, Prefect) vs declarative DAG (Airflow) vs asset-centric (Dagster)"
  - question: "What task states are essential?"
    answer: "PENDING, RUNNING, RETRYING, COMPLETED, FAILED (5 states sufficient)"
  - question: "Which trigger patterns for MCP?"
    answer: "Manual + cron for MVP; skip event sensors and message queues"
  - question: "Simple retry pattern?"
    answer: "Exponential backoff with initial=1s, coefficient=2.0, max_attempts=3"
  - question: "What to skip?"
    answer: "Worker pools, K8s operators, event sourcing, distributed execution"

outputs:
  - file: "01_PATTERN_CATALOG.md"
    lines: ~280
    content: "Comprehensive pattern catalog across all four tools"
  - file: "02_SMCP_RECOMMENDATIONS.md"
    lines: ~200
    content: "ADOPT/SIMPLIFY/SKIP recommendations for Judith implementation"

sources:
  primary:
    - name: "Temporal.io Documentation"
      url: "https://docs.temporal.io/"
      topics:
        - workflow definitions
        - retry policies
        - signals and timers
    - name: "Apache Airflow Documentation"
      url: "https://airflow.apache.org/docs/"
      topics:
        - DAG patterns
        - task states
        - event-driven scheduling
    - name: "Prefect Documentation"
      url: "https://docs.prefect.io/"
      topics:
        - flow/task decorators
        - state machine
        - automations
    - name: "Dagster Documentation"
      url: "https://docs.dagster.io/"
      topics:
        - software-defined assets
        - ops and jobs
        - sensors and schedules
  secondary:
    - name: "The Fallacy of the Graph (Temporal Blog)"
      url: "https://temporal.io/blog/the-fallacy-of-the-graph-why-your-next-workflow-should-be-code-not-a-diagram"
    - name: "Prefect Workflow Design Patterns"
      url: "https://www.prefect.io/blog/workflow-design-patterns"
    - name: "State of Workflow Orchestration 2025"
      url: "https://www.pracdata.io/p/state-of-workflow-orchestration-ecosystem-2025"
    - name: "Dagu - Lightweight Alternative"
      url: "https://dagu.io/"

recommendations_summary:
  adopt:
    - "Code-first workflow definition with decorators"
    - "Simple 5-state task state machine"
    - "Exponential backoff retry strategy"
    - "Manual and cron triggers"
    - "File-based state persistence (JSON/SQLite)"
    - "Structured logging"
  simplify:
    - "Workflow composition (just function calls)"
    - "Error handling (standard try/except)"
    - "Concurrency (asyncio, not worker pools)"
  skip:
    - "YAML/declarative DAG definitions"
    - "Asset-centric data model"
    - "Event sourcing / workflow replay"
    - "Distributed worker pools"
    - "Kubernetes operators"
    - "Message queue integration"
    - "Complex sensor systems"
    - "Saga compensation patterns"
    - "Circuit breakers"
    - "Distributed tracing"

tags:
  - workflow-orchestration
  - smcp
  - judith
  - temporal
  - airflow
  - prefect
  - dagster
  - mcp
